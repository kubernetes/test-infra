# Code generated by cluster-api's prowjob-gen. DO NOT EDIT.
presubmits:
  kubernetes-sigs/cluster-api-provider-vsphere:
    - name: pull-cluster-api-provider-vsphere-apidiff-main
      cluster: eks-prow-build-cluster
      branches:
        - ^main$
      always_run: false
      # Run if go files, scripts or configuration changed (we use the same for all jobs for simplicity).
      run_if_changed: '^((apis|config|controllers|feature|hack|packaging|pkg|test|webhooks)/|Dockerfile|go\.mod|go\.sum|main\.go|Makefile)'
      optional: true
      decorate: true
      decoration_config:
        timeout: 120m
      path_alias: sigs.k8s.io/cluster-api-provider-vsphere
      spec:
        containers:
          - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20241230-3006692a6f-1.30
            command:
              - runner.sh
            args:
              - ./hack/ci-apidiff.sh
            resources:
              limits:
                cpu: 2
                memory: 3Gi
              requests:
                cpu: 2
                memory: 3Gi
      annotations:
        testgrid-dashboards: vmware-cluster-api-provider-vsphere, sig-cluster-lifecycle-cluster-api-provider-vsphere
        testgrid-tab-name: pr-apidiff-main
        description: Checks for API changes in the PR
    - name: pull-cluster-api-provider-vsphere-verify-main
      cluster: eks-prow-build-cluster
      branches:
        - ^main$
      labels:
        preset-dind-enabled: "true"
      always_run: true
      decorate: true
      decoration_config:
        timeout: 120m
      path_alias: sigs.k8s.io/cluster-api-provider-vsphere
      spec:
        containers:
          - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20241230-3006692a6f-1.30
            command:
              - runner.sh
            args:
              - make
              - verify
            # we need privileged mode in order to do docker in docker
            securityContext:
              privileged: true
            resources:
              limits:
                cpu: 2
                memory: 3Gi
              requests:
                cpu: 2
                memory: 3Gi
      annotations:
        testgrid-dashboards: vmware-cluster-api-provider-vsphere, sig-cluster-lifecycle-cluster-api-provider-vsphere
        testgrid-tab-name: pr-verify-main
    - name: pull-cluster-api-provider-vsphere-test-main
      cluster: eks-prow-build-cluster
      branches:
        - ^main$
      always_run: false
      # Run if go files, scripts or configuration changed (we use the same for all jobs for simplicity).
      run_if_changed: '^((apis|config|controllers|feature|hack|packaging|pkg|test|webhooks)/|Dockerfile|go\.mod|go\.sum|main\.go|Makefile)'
      decorate: true
      decoration_config:
        timeout: 120m
      path_alias: sigs.k8s.io/cluster-api-provider-vsphere
      spec:
        containers:
          - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20241230-3006692a6f-1.30
            resources:
              limits:
                cpu: 2
                memory: 4Gi
              requests:
                cpu: 2
                memory: 4Gi
            command:
              - runner.sh
            args:
              - make
              - test-junit
      annotations:
        testgrid-dashboards: vmware-cluster-api-provider-vsphere, sig-cluster-lifecycle-cluster-api-provider-vsphere
        testgrid-tab-name: pr-test-main
        description: Runs unit tests
    - name: pull-cluster-api-provider-vsphere-e2e-vcsim-govmomi-main
      cluster: eks-prow-build-cluster
      branches:
        - ^main$
      labels:
        preset-dind-enabled: "true"
        preset-kind-volume-mounts: "true"
      always_run: false
      decorate: true
      decoration_config:
        timeout: 180m
      path_alias: sigs.k8s.io/cluster-api-provider-vsphere
      max_concurrency: 3
      extra_refs:
        - org: kubernetes
          repo: kubernetes
          base_ref: master
          path_alias: k8s.io/kubernetes
      spec:
        containers:
          - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20241230-3006692a6f-1.30
            command:
              - runner.sh
            args:
              - ./hack/e2e.sh
            env:
              - name: GINKGO_FOCUS
                value: "\\[vcsim\\]"
            # we need privileged mode in order to do docker in docker
            securityContext:
              privileged: true
              capabilities:
                add: ["NET_ADMIN"]
            resources:
              requests:
                cpu: "4000m"
                memory: "3Gi"
              limits:
                cpu: "4000m"
                memory: "3Gi"
      annotations:
        testgrid-dashboards: vmware-cluster-api-provider-vsphere, sig-cluster-lifecycle-cluster-api-provider-vsphere
        testgrid-tab-name: pr-e2e-vcsim-govmomi-main
        description: Runs e2e tests with vcsim / govmomi mode
    - name: pull-cluster-api-provider-vsphere-e2e-vcsim-supervisor-main
      cluster: eks-prow-build-cluster
      branches:
        - ^main$
      labels:
        preset-dind-enabled: "true"
        preset-kind-volume-mounts: "true"
      always_run: false
      decorate: true
      decoration_config:
        timeout: 180m
      path_alias: sigs.k8s.io/cluster-api-provider-vsphere
      max_concurrency: 3
      extra_refs:
        - org: kubernetes
          repo: kubernetes
          base_ref: master
          path_alias: k8s.io/kubernetes
      spec:
        containers:
          - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20241230-3006692a6f-1.30
            command:
              - runner.sh
            args:
              - ./hack/e2e.sh
            env:
              - name: GINKGO_FOCUS
                value: "\\[vcsim\\] \\[supervisor\\]"
            # we need privileged mode in order to do docker in docker
            securityContext:
              privileged: true
              capabilities:
                add: ["NET_ADMIN"]
            resources:
              requests:
                cpu: "4000m"
                memory: "3Gi"
              limits:
                cpu: "4000m"
                memory: "3Gi"
      annotations:
        testgrid-dashboards: vmware-cluster-api-provider-vsphere, sig-cluster-lifecycle-cluster-api-provider-vsphere
        testgrid-tab-name: pr-e2e-vcsim-supervisor-main
        description: Runs e2e tests with vcsim / govmomi mode
