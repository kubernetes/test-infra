# Test jobs generated by build_jobs.py (do not manually edit)
# 3 jobs
presubmits:
  kubernetes/kops:

# {"cloud": "aws", "distro": "u2204", "k8s_version": "stable", "kops_channel": "alpha", "networking": "amazonvpc"}
  - name: presubmit-kops-aws-scale-amazonvpc
    cluster: eks-prow-build-cluster
    branches:
    - master
    always_run: false
    optional: false
    skip_report: false
    labels:
      preset-service-account: "true"
      preset-aws-ssh: "true"
      preset-aws-credential: "true"
      preset-dind-enabled: "true"
    max_concurrency: 1
    decorate: true
    decoration_config:
      timeout: 90m
    path_alias: k8s.io/kops
    extra_refs:
    - org: kubernetes
      repo: perf-tests
      base_ref: master
      path_alias: k8s.io/perf-tests
    spec:
      containers:
      - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20231206-f7b83ffbe6-master
        imagePullPolicy: Always
        command:
        - runner.sh
        args:
        - ./tests/e2e/scenarios/scalability/run-test.sh
        securityContext:
          privileged: true
        env:
        - name: KUBE_SSH_KEY_PATH
          value: /etc/aws-ssh/aws-ssh-private
        - name: KUBE_SSH_USER
          value: ubuntu
        - name: GOPATH
          value: /home/prow/go
        - name: CNI_PLUGIN
          value: "amazonvpc"
        - name: CLOUD_PROVIDER
          value: "aws"
        - name: CLUSTER_NAME
          value: "e2e-ed860ed5de-2df82.test-cncf-aws.k8s.io"
        - name: KOPS_STATE_STORE
          value: "s3://k8s-kops-prow"
        - name: KOPS_IRSA
          value: "true"
        resources:
          requests:
            cpu: "6"
            memory: "16Gi"
          limits:
            cpu: "6"
            memory: "16Gi"
    annotations:
      test.kops.k8s.io/cloud: aws
      test.kops.k8s.io/distro: u2204
      test.kops.k8s.io/k8s_version: stable
      test.kops.k8s.io/kops_channel: alpha
      test.kops.k8s.io/networking: amazonvpc
      testgrid-dashboards: kops-presubmits, presubmits-kops, sig-cluster-lifecycle-kops
      testgrid-days-of-results: '90'
      testgrid-tab-name: presubmit-kops-aws-scale-amazonvpc

# {"cloud": "aws", "distro": "u2204", "k8s_version": "stable", "kops_channel": "alpha", "networking": "amazonvpc"}
  - name: presubmit-kops-aws-scale-amazonvpc-using-cl2
    cluster: eks-prow-build-cluster
    branches:
    - master
    always_run: false
    optional: false
    skip_report: false
    labels:
      preset-service-account: "true"
      preset-aws-ssh: "true"
      preset-aws-credential-boskos-scale-001-kops: "true"
      preset-dind-enabled: "true"
    max_concurrency: 1
    decorate: true
    decoration_config:
      timeout: 480m
    path_alias: k8s.io/kops
    extra_refs:
    - org: kubernetes
      repo: perf-tests
      base_ref: master
      path_alias: k8s.io/perf-tests
    spec:
      containers:
      - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20231206-f7b83ffbe6-master
        imagePullPolicy: Always
        command:
        - runner.sh
        args:
        - ./tests/e2e/scenarios/scalability/run-test.sh
        securityContext:
          privileged: true
        env:
        - name: KUBE_SSH_KEY_PATH
          value: /etc/aws-ssh/aws-ssh-private
        - name: KUBE_SSH_USER
          value: ubuntu
        - name: GOPATH
          value: /home/prow/go
        - name: ARTIFACTS
          value: $(ARTIFACTS)
        - name: CNI_PLUGIN
          value: "amazonvpc"
        - name: KUBE_NODE_COUNT
          value: "5000"
        - name: CL2_LOAD_TEST_THROUGHPUT
          value: "50"
        - name: CL2_DELETE_TEST_THROUGHPUT
          value: "50"
        - name: CL2_RATE_LIMIT_POD_CREATION
          value: "false"
        - name: NODE_MODE
          value: "master"
        - name: CONTROL_PLANE_COUNT
          value: "3"
        - name: CONTROL_PLANE_SIZE
          value: "c5.18xlarge"
        - name: KOPS_STATE_STORE
          value: "s3://k8s-infra-kops-scale-tests"
        - name: PROMETHEUS_SCRAPE_KUBE_PROXY
          value: "true"
        - name: CL2_ENABLE_DNS_PROGRAMMING
          value: "true"
        - name: CL2_ENABLE_API_AVAILABILITY_MEASUREMENT
          value: "true"
        - name: CL2_API_AVAILABILITY_PERCENTAGE_THRESHOLD
          value: "99.5"
        - name: CL2_ALLOWED_SLOW_API_CALLS
          value: "1"
        - name: ENABLE_PROMETHEUS_SERVER
          value: "true"
        - name: PROMETHEUS_PVC_STORAGE_CLASS
          value: "gp2"
        - name: CL2_NETWORK_LATENCY_THRESHOLD
          value: "0.5s"
        - name: CL2_ENABLE_VIOLATIONS_FOR_NETWORK_PROGRAMMING_LATENCIES
          value: "true"
        - name: CL2_NETWORK_PROGRAMMING_LATENCY_THRESHOLD
          value: "20s"
        - name: CL2_ENABLE_DNSTESTS
          value: "true"
        - name: CL2_USE_ADVANCED_DNSTEST
          value: "true"
        - name: CLOUD_PROVIDER
          value: "aws"
        - name: CLUSTER_NAME
          value: "e2e-ff02749ef8-a423a.test-cncf-aws.k8s.io"
        - name: KOPS_IRSA
          value: "true"
        resources:
          requests:
            cpu: "6"
            memory: "16Gi"
          limits:
            cpu: "6"
            memory: "16Gi"
    annotations:
      test.kops.k8s.io/cloud: aws
      test.kops.k8s.io/distro: u2204
      test.kops.k8s.io/k8s_version: stable
      test.kops.k8s.io/kops_channel: alpha
      test.kops.k8s.io/networking: amazonvpc
      testgrid-dashboards: kops-presubmits, presubmits-kops, sig-cluster-lifecycle-kops
      testgrid-days-of-results: '90'
      testgrid-tab-name: presubmit-kops-aws-scale-amazonvpc-using-cl2

# {"cloud": "aws", "distro": "u2204", "k8s_version": "stable", "kops_channel": "alpha", "networking": "amazonvpc"}
  - name: presubmit-kops-aws-small-scale-amazonvpc-using-cl2
    cluster: eks-prow-build-cluster
    branches:
    - master
    always_run: false
    optional: false
    skip_report: false
    labels:
      preset-service-account: "true"
      preset-aws-ssh: "true"
      preset-aws-credential-boskos-scale-001-kops: "true"
      preset-dind-enabled: "true"
    max_concurrency: 1
    decorate: true
    decoration_config:
      timeout: 480m
    path_alias: k8s.io/kops
    extra_refs:
    - org: kubernetes
      repo: perf-tests
      base_ref: master
      path_alias: k8s.io/perf-tests
    spec:
      containers:
      - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20231206-f7b83ffbe6-master
        imagePullPolicy: Always
        command:
        - runner.sh
        args:
        - ./tests/e2e/scenarios/scalability/run-test.sh
        securityContext:
          privileged: true
        env:
        - name: KUBE_SSH_KEY_PATH
          value: /etc/aws-ssh/aws-ssh-private
        - name: KUBE_SSH_USER
          value: ubuntu
        - name: GOPATH
          value: /home/prow/go
        - name: ARTIFACTS
          value: $(ARTIFACTS)
        - name: CNI_PLUGIN
          value: "amazonvpc"
        - name: KUBE_NODE_COUNT
          value: "100"
        - name: CL2_SCHEDULER_THROUGHPUT_THRESHOLD
          value: "20"
        - name: CONTROL_PLANE_COUNT
          value: "3"
        - name: CONTROL_PLANE_SIZE
          value: "c5.4xlarge"
        - name: CL2_LOAD_TEST_THROUGHPUT
          value: "50"
        - name: CL2_DELETE_TEST_THROUGHPUT
          value: "50"
        - name: CL2_RATE_LIMIT_POD_CREATION
          value: "false"
        - name: NODE_MODE
          value: "master"
        - name: KOPS_STATE_STORE
          value: "s3://k8s-infra-kops-scale-tests"
        - name: PROMETHEUS_SCRAPE_KUBE_PROXY
          value: "true"
        - name: CL2_ENABLE_DNS_PROGRAMMING
          value: "true"
        - name: CL2_ENABLE_API_AVAILABILITY_MEASUREMENT
          value: "true"
        - name: CL2_API_AVAILABILITY_PERCENTAGE_THRESHOLD
          value: "99.5"
        - name: CL2_ALLOWED_SLOW_API_CALLS
          value: "1"
        - name: ENABLE_PROMETHEUS_SERVER
          value: "true"
        - name: PROMETHEUS_PVC_STORAGE_CLASS
          value: "gp2"
        - name: CLOUD_PROVIDER
          value: "aws"
        - name: CLUSTER_NAME
          value: "e2e-fa029a0ba8-a2033.test-cncf-aws.k8s.io"
        - name: KOPS_IRSA
          value: "true"
        resources:
          requests:
            cpu: "6"
            memory: "16Gi"
          limits:
            cpu: "6"
            memory: "16Gi"
    annotations:
      test.kops.k8s.io/cloud: aws
      test.kops.k8s.io/distro: u2204
      test.kops.k8s.io/k8s_version: stable
      test.kops.k8s.io/kops_channel: alpha
      test.kops.k8s.io/networking: amazonvpc
      testgrid-dashboards: kops-presubmits, presubmits-kops, sig-cluster-lifecycle-kops
      testgrid-days-of-results: '90'
      testgrid-tab-name: presubmit-kops-aws-small-scale-amazonvpc-using-cl2
