presubmits:
  kubernetes/k8s.io:
    - name: pull-k8sio-groups-test
      cluster: eks-prow-build-cluster
      annotations:
        testgrid-create-test-group: "true"
        testgrid-dashboards: sig-k8s-infra-groups
      decorate: true
      path_alias: k8s.io/k8s.io
      run_if_changed: "^groups/"
      branches:
        - ^main$
      spec:
        containers:
          - image: gcr.io/k8s-staging-infra-tools/k8s-infra:latest
            command:
              - make
            args:
              - -C
              - ./groups
              - test
            resources:
              limits:
                cpu: 1
                memory: "1Gi"
              requests:
                cpu: 1
                memory: "1Gi"
            env:
              - name: GO111MODULE
                value: "on"
    - name: pull-k8sio-verify
      cluster: k8s-infra-prow-build
      annotations:
        testgrid-dashboards: sig-k8s-infra-k8sio
        testgrid-tab-name: pull-k8sio-verify
      always_run: true
      decorate: true
      spec:
        containers:
          - image: gcr.io/k8s-staging-infra-tools/k8s-infra:latest
            command:
              - ./hack/verify.sh
            resources:
              limits:
                cpu: 1
                memory: "512Mi"
              requests:
                cpu: 1
                memory: "512Mi"
    - name: pull-k8sio-dns-validate-config
      cluster: eks-prow-build-cluster
      run_if_changed: "^dns/"
      annotations:
        testgrid-dashboards: sig-k8s-infra-k8sio
        testgrid-tab-name: pull-k8sio-dns-validate-config
      decorate: true
      spec:
        containers:
          - image: registry.k8s.io/infra-tools/octodns:v20220319-97d14a558
            command:
              - bash
            args:
              - -c
              - "cd dns && make validate-config"
            resources:
              limits:
                cpu: 1
                memory: "512Mi"
              requests:
                cpu: 1
                memory: "512Mi"
